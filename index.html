<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <title>图片水印打码工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              notion: {
                bg: '#ffffff',
                sidebar: '#fbfbfa',
                hover: '#efefef',
                border: '#e3e2e0',
                text: '#37352f',
                muted: '#9b9a97',
                brown: '#9f6b53',
              },
            },
            fontFamily: {
              display: [
                '"Noto Sans SC"',
                '"PingFang SC"',
                '"Microsoft YaHei"',
                'system-ui',
                'sans-serif',
              ],
            },
          },
        },
      };
    </script>
    <style>
      #drop-zone.drag-over {
        border-color: #37352f;
        background-color: #efefef;
      }
      .control-disabled {
        opacity: 0.4;
        pointer-events: none;
        transition: opacity 0.2s ease;
      }
    </style>
  </head>
  <body class="min-h-screen bg-notion-bg py-6 text-notion-text lg:py-10">
    <main class="mx-auto w-full max-w-6xl px-4">
      <header class="mb-6 space-y-2">
        <p class="text-sm text-notion-muted">Local Watermark Studio</p>
        <h1 class="font-display text-3xl font-bold text-notion-text">
          图片水印打码工具
        </h1>
        <p class="text-sm text-notion-muted">
          安全地为你的图片添加水印，全程本地处理，特别适用于身份证、驾照、护照等敏感证件。
        </p>
      </header>

      <div class="flex flex-col gap-6 lg:flex-row lg:items-stretch">
        <!-- 左侧设置区 -->
        <div class="w-full space-y-4 lg:w-[400px] lg:flex-shrink-0">
          <!-- 第一步：上传图片 -->
          <div id="drop-zone" class="rounded-md border-2 border-dashed border-notion-border bg-notion-sidebar p-4 text-center transition-colors">
            <p class="text-sm font-medium text-notion-text">拖拽图片到此处，或粘贴 (Ctrl+V)</p>
            <p class="mt-1 text-xs text-notion-muted">支持 PNG / JPG / GIF</p>
            <input
              type="file"
              id="image"
              accept="image/png,image/jpeg,image/gif"
              autocomplete="off"
              class="mt-2 block w-full cursor-pointer rounded border border-notion-border bg-white px-2 py-1.5 text-xs text-notion-text file:mr-2 file:cursor-pointer file:rounded file:border-0 file:bg-notion-text file:px-2 file:py-1 file:text-xs file:font-medium file:text-white hover:file:bg-notion-text/80"
            />
          </div>

          <!-- 第二步：水印设置 -->
          <div class="rounded-md border border-notion-border bg-notion-sidebar p-4 space-y-4">
            <!-- 水印类型 -->
            <div class="flex gap-2 text-sm">
              <label class="cursor-pointer">
                <input type="radio" name="watermark-type" value="text" checked class="peer sr-only" />
                <span class="rounded border border-notion-border px-3 py-1 peer-checked:bg-notion-text peer-checked:text-white">文字水印</span>
              </label>
              <label class="cursor-pointer">
                <input type="radio" name="watermark-type" value="image" class="peer sr-only" />
                <span class="rounded border border-notion-border px-3 py-1 peer-checked:bg-notion-text peer-checked:text-white">图片水印</span>
              </label>
            </div>

            <!-- 文字输入 -->
            <div id="text-watermark">
              <input
                type="text"
                id="text"
                placeholder="请输入水印文字，30 字以内"
                autocomplete="off"
                maxlength="30"
                class="w-full rounded border border-notion-border bg-white px-3 py-2 text-sm text-notion-text placeholder-notion-muted outline-none transition focus:border-notion-text"
              />
            </div>

            <!-- 图片上传 -->
            <div id="image-watermark" class="hidden">
              <input
                type="file"
                id="watermark-image"
                accept="image/png,image/jpeg,image/gif"
                class="w-full cursor-pointer rounded border border-notion-border bg-white px-2 py-1.5 text-xs text-notion-text file:mr-2 file:cursor-pointer file:rounded file:border-0 file:bg-notion-text file:px-2 file:py-1 file:text-xs file:font-medium file:text-white"
              />
              <p class="mt-1 text-xs text-notion-muted">建议使用透明背景的 PNG</p>
            </div>

            <!-- 水印位置 -->
            <div>
              <p class="text-xs font-medium text-notion-muted mb-2">位置</p>
              <div class="flex flex-wrap gap-1.5 text-xs">
                <label class="cursor-pointer">
                  <input type="radio" name="position" value="tile" checked class="peer sr-only" />
                  <span class="rounded border border-notion-border px-2 py-1 peer-checked:bg-notion-text peer-checked:text-white">平铺</span>
                </label>
                <label class="cursor-pointer">
                  <input type="radio" name="position" value="top-left" class="peer sr-only" />
                  <span class="rounded border border-notion-border px-2 py-1 peer-checked:bg-notion-text peer-checked:text-white">左上</span>
                </label>
                <label class="cursor-pointer">
                  <input type="radio" name="position" value="top-right" class="peer sr-only" />
                  <span class="rounded border border-notion-border px-2 py-1 peer-checked:bg-notion-text peer-checked:text-white">右上</span>
                </label>
                <label class="cursor-pointer">
                  <input type="radio" name="position" value="bottom-left" class="peer sr-only" />
                  <span class="rounded border border-notion-border px-2 py-1 peer-checked:bg-notion-text peer-checked:text-white">左下</span>
                </label>
                <label class="cursor-pointer">
                  <input type="radio" name="position" value="bottom-right" class="peer sr-only" />
                  <span class="rounded border border-notion-border px-2 py-1 peer-checked:bg-notion-text peer-checked:text-white">右下</span>
                </label>
                <label class="cursor-pointer">
                  <input type="radio" name="position" value="center" class="peer sr-only" />
                  <span class="rounded border border-notion-border px-2 py-1 peer-checked:bg-notion-text peer-checked:text-white">居中</span>
                </label>
              </div>
            </div>

            <!-- 颜色（仅文字水印） -->
            <div id="color-control" class="rounded border border-notion-border bg-white p-3">
              <div class="flex items-center justify-between text-xs font-medium text-notion-text">
                <span>颜色</span>
                <span id="color-value" class="font-mono text-notion-muted">#7F7F7F</span>
              </div>
              <div class="mt-2 flex items-center gap-2">
                <span id="color-chip" class="h-8 w-10 rounded border border-notion-border" style="background: #7f7f7f"></span>
                <label for="color" class="relative flex flex-1 cursor-pointer items-center justify-center rounded border border-notion-border bg-notion-sidebar px-2 py-1 text-xs text-notion-text hover:bg-notion-hover">
                  选取
                  <input type="color" id="color" autocomplete="off" value="#7F7F7F" class="absolute h-0 w-0 opacity-0" />
                </label>
              </div>
              <div class="mt-2 grid grid-cols-4 gap-1 text-xs">
                <button type="button" data-color-preset="#222222" class="rounded bg-notion-text py-1 text-white">深</button>
                <button type="button" data-color-preset="#f97316" class="rounded bg-orange-500 py-1 text-white">橙</button>
                <button type="button" data-color-preset="#9f6b53" class="rounded bg-notion-brown py-1 text-white">棕</button>
                <button type="button" data-color-preset="#f8fafc" class="rounded border border-notion-border bg-white py-1 text-notion-text">浅</button>
              </div>
            </div>

            <!-- 参数调节 -->
            <div class="grid grid-cols-2 gap-3">
              <div class="rounded border border-notion-border bg-white px-3 py-2">
                <div class="flex items-center justify-between text-xs text-notion-text">
                  <label for="alpha">透明度</label>
                  <span id="alpha-value" class="text-notion-muted">50%</span>
                </div>
                <input type="range" id="alpha" min="0" max="1" step="0.05" autocomplete="off" value="0.5" class="mt-1 w-full cursor-pointer accent-notion-text" />
              </div>

              <div class="rounded border border-notion-border bg-white px-3 py-2">
                <div class="flex items-center justify-between text-xs text-notion-text">
                  <label for="size">大小</label>
                  <span id="size-value" class="text-notion-muted">1.0×</span>
                </div>
                <input type="range" id="size" min="0.5" max="3" step="0.05" autocomplete="off" value="1" class="mt-1 w-full cursor-pointer accent-notion-text" />
              </div>

              <div id="angle-control" class="rounded border border-notion-border bg-white px-3 py-2">
                <div class="flex items-center justify-between text-xs text-notion-text">
                  <label for="angle">角度</label>
                  <span id="angle-value" class="text-notion-muted">45°</span>
                </div>
                <input type="range" id="angle" min="-90" max="90" step="3" autocomplete="off" value="45" class="mt-1 w-full cursor-pointer accent-notion-text" />
              </div>

              <div id="space-control" class="rounded border border-notion-border bg-white px-3 py-2">
                <div class="flex items-center justify-between text-xs text-notion-text">
                  <label for="space">行距</label>
                  <span id="space-value" class="text-notion-muted">4×</span>
                </div>
                <input type="range" id="space" min="1" max="8" step="0.2" autocomplete="off" value="4" class="mt-1 w-full cursor-pointer accent-notion-text" />
              </div>

              <div id="inline-control" class="col-span-2 rounded border border-notion-border bg-white px-3 py-2">
                <div class="flex items-center justify-between text-xs text-notion-text">
                  <label for="inline">横向间距</label>
                  <span id="inline-value" class="text-notion-muted">1.0×</span>
                </div>
                <input type="range" id="inline" min="0" max="4" step="0.1" autocomplete="off" value="1" class="mt-1 w-full cursor-pointer accent-notion-text" />
              </div>
            </div>

            <!-- 操作按钮 -->
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="flex items-center gap-2 text-xs text-notion-text">
                  <input type="checkbox" id="auto-refresh" autocomplete="off" checked class="h-3.5 w-3.5 rounded border-notion-border text-notion-text" />
                  <label for="auto-refresh" class="cursor-pointer">实时预览</label>
                </div>
                <button id="refresh" disabled class="rounded bg-notion-text px-3 py-1 text-xs font-medium text-white disabled:cursor-not-allowed disabled:bg-notion-muted">
                  刷新
                </button>
              </div>
              <div class="flex items-center gap-2">
                <button id="reset" class="rounded border border-notion-border px-3 py-1 text-xs text-notion-text hover:bg-notion-hover">
                  重置
                </button>
                <button id="download" disabled class="rounded bg-notion-text px-3 py-1 text-xs font-medium text-white disabled:cursor-not-allowed disabled:bg-notion-muted">
                  下载
                </button>
              </div>
            </div>
          </div>

        </div>

        <!-- 右侧预览区 -->
        <div class="flex-1 min-w-0 flex flex-col">
          <div id="graph" class="w-full flex-1 rounded-md border border-notion-border bg-notion-sidebar p-2 min-h-[200px] flex items-center justify-center text-notion-muted text-sm overflow-auto">
            请先上传图片
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="mt-8 flex items-center justify-center">
        <a href="https://github.com/mingzaily/watermarking" class="flex items-center gap-2 rounded px-3 py-1.5 text-xs text-notion-muted hover:bg-notion-hover">
          <img src="https://cdn.jsdelivr.net/gh/Closty/duanwangzhi/github.png" alt="GitHub" class="h-4 w-4 opacity-60" />
          开源地址
        </a>
      </footer>
    </main>
    <script src="./main.js"></script>
  </body>
</html>
